<?xml version="1.0" encoding="UTF-8"?>
<!-- ============================================================================
     POM.XML - Project Structure Generator
     ============================================================================
     Fichier: project-generator/pom.xml
     ============================================================================ -->
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
         http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.nexusai</groupId>
    <artifactId>project-structure-generator</artifactId>
    <version>1.0.0</version>
    <packaging>jar</packaging>

    <name>NexusAI Project Structure Generator</name>
    <description>Outil pour générer l'arborescence projet depuis documentation</description>

    <properties>
        <java.version>21</java.version>
        <maven.compiler.source>21</maven.compiler.source>
        <maven.compiler.target>21</maven.compiler.target>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <lombok.version>1.18.30</lombok.version>
        <slf4j.version>2.0.9</slf4j.version>
        <logback.version>1.4.11</logback.version>
        <junit.version>5.10.1</junit.version>
    </properties>

    <dependencies>
        <!-- Lombok -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <version>${lombok.version}</version>
            <scope>provided</scope>
        </dependency>

        <!-- Logging -->
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>${slf4j.version}</version>
        </dependency>
        <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-classic</artifactId>
            <version>${logback.version}</version>
        </dependency>

        <!-- Tests -->
        <dependency>
            <groupId>org.junit.jupiter</groupId>
            <artifactId>junit-jupiter</artifactId>
            <version>${junit.version}</version>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <!-- Compiler Plugin -->
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.11.0</version>
                <configuration>
                    <source>${java.version}</source>
                    <target>${java.version}</target>
                    <annotationProcessorPaths>
                        <path>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                            <version>${lombok.version}</version>
                        </path>
                    </annotationProcessorPaths>
                </configuration>
            </plugin>

            <!-- JAR Plugin avec Main Class -->
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-jar-plugin</artifactId>
                <version>3.3.0</version>
                <configuration>
                    <archive>
                        <manifest>
                            <mainClass>com.nexusai.tools.ProjectStructureGenerator</mainClass>
                            <addClasspath>true</addClasspath>
                        </manifest>
                    </archive>
                </configuration>
            </plugin>

            <!-- Assembly Plugin pour créer un JAR exécutable avec dépendances -->
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-assembly-plugin</artifactId>
                <version>3.6.0</version>
                <configuration>
                    <descriptorRefs>
                        <descriptorRef>jar-with-dependencies</descriptorRef>
                    </descriptorRefs>
                    <archive>
                        <manifest>
                            <mainClass>com.nexusai.tools.ProjectStructureGenerator</mainClass>
                        </manifest>
                    </archive>
                </configuration>
                <executions>
                    <execution>
                        <id>make-assembly</id>
                        <phase>package</phase>
                        <goals>
                            <goal>single</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>

            <!-- Surefire Plugin pour tests -->
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <version>3.1.2</version>
            </plugin>
        </plugins>
    </build>
</project>

<!-- ============================================================================
     SCRIPT BASH - generate-project.sh
     ============================================================================
     Fichier: scripts/generate-project.sh
     ============================================================================ -->
#!/bin/bash

set -e

# Couleurs
GREEN='\033[0;32m'
BLUE='\033[0;34m'
RED='\033[0;31m'
YELLOW='\033[1;33m'
NC='\033[0m'

# Configuration
GENERATOR_JAR="target/project-structure-generator-1.0.0-jar-with-dependencies.jar"
DEFAULT_OUTPUT="./nexusai-generated"

print_header() {
    echo -e "${BLUE}"
    echo "╔════════════════════════════════════════════════════════════╗"
    echo "║        NEXUSAI PROJECT STRUCTURE GENERATOR                 ║"
    echo "╚════════════════════════════════════════════════════════════╝"
    echo -e "${NC}"
}

print_usage() {
    echo "Usage: $0 [OPTIONS] <input-file>"
    echo ""
    echo "Options:"
    echo "  -o, --output PATH      Chemin de sortie (défaut: $DEFAULT_OUTPUT)"
    echo "  -w, --overwrite        Écraser les fichiers existants"
    echo "  -b, --no-backup        Ne pas créer de backup"
    echo "  -h, --help             Afficher cette aide"
    echo ""
    echo "Exemples:"
    echo "  $0 docs/module-7.md"
    echo "  $0 -o ./output -w docs/module-7.md"
    echo "  $0 --no-backup docs/module-7.md"
}

build_if_needed() {
    if [ ! -f "$GENERATOR_JAR" ]; then
        echo -e "${YELLOW}JAR non trouvé. Compilation en cours...${NC}"
        mvn clean package -DskipTests
        
        if [ $? -ne 0 ]; then
            echo -e "${RED}Erreur lors de la compilation${NC}"
            exit 1
        fi
        
        echo -e "${GREEN}✓ Compilation réussie${NC}"
    fi
}

# Variables par défaut
OUTPUT_PATH="$DEFAULT_OUTPUT"
OVERWRITE=""
NO_BACKUP=""

# Parse des arguments
while [[ $# -gt 0 ]]; do
    case $1 in
        -o|--output)
            OUTPUT_PATH="$2"
            shift 2
            ;;
        -w|--overwrite)
            OVERWRITE="--overwrite"
            shift
            ;;
        -b|--no-backup)
            NO_BACKUP="--no-backup"
            shift
            ;;
        -h|--help)
            print_usage
            exit 0
            ;;
        -*)
            echo -e "${RED}Option inconnue: $1${NC}"
            print_usage
            exit 1
            ;;
        *)
            INPUT_FILE="$1"
            shift
            ;;
    esac
done

# Validation
if [ -z "$INPUT_FILE" ]; then
    echo -e "${RED}Erreur: Fichier d'entrée requis${NC}"
    print_usage
    exit 1
fi

if [ ! -f "$INPUT_FILE" ]; then
    echo -e "${RED}Erreur: Fichier non trouvé: $INPUT_FILE${NC}"
    exit 1
fi

# Affichage
print_header

echo -e "${BLUE}Configuration:${NC}"
echo "  Fichier d'entrée: $INPUT_FILE"
echo "  Répertoire de sortie: $OUTPUT_PATH"
echo "  Écraser: ${OVERWRITE:-Non}"
echo "  Backup: ${NO_BACKUP:-Oui}"
echo ""

# Build si nécessaire
build_if_needed

# Exécution
echo -e "${BLUE}Génération en cours...${NC}"
echo ""

java -jar "$GENERATOR_JAR" "$INPUT_FILE" "$OUTPUT_PATH" $OVERWRITE $NO_BACKUP

if [ $? -eq 0 ]; then
    echo ""
    echo -e "${GREEN}╔════════════════════════════════════════════════════════════╗${NC}"
    echo -e "${GREEN}║              GÉNÉRATION TERMINÉE AVEC SUCCÈS !             ║${NC}"
    echo -e "${GREEN}╚════════════════════════════════════════════════════════════╝${NC}"
    echo ""
    echo -e "${BLUE}Répertoire de sortie:${NC} $(cd "$OUTPUT_PATH" && pwd)"
    echo ""
    echo -e "${BLUE}Structure générée:${NC}"
    tree -L 3 "$OUTPUT_PATH" 2>/dev/null || find "$OUTPUT_PATH" -type d | head -20
else
    echo ""
    echo -e "${RED}✗ Erreur lors de la génération${NC}"
    exit 1
fi

<!-- ============================================================================
     SCRIPT WINDOWS - generate-project.bat
     ============================================================================
     Fichier: scripts/generate-project.bat
     ============================================================================ -->
@echo off
setlocal enabledelayedexpansion

:: Configuration
set GENERATOR_JAR=target\project-structure-generator-1.0.0-jar-with-dependencies.jar
set DEFAULT_OUTPUT=.\nexusai-generated

:: Couleurs (Windows 10+)
set GREEN=[92m
set BLUE=[94m
set RED=[91m
set YELLOW=[93m
set NC=[0m

:header
echo %BLUE%
echo ╔════════════════════════════════════════════════════════════╗
echo ║        NEXUSAI PROJECT STRUCTURE GENERATOR                 ║
echo ╚════════════════════════════════════════════════════════════╝
echo %NC%
goto :main

:usage
echo Usage: %0 [OPTIONS] input-file
echo.
echo Options:
echo   -o PATH        Chemin de sortie (defaut: %DEFAULT_OUTPUT%)
echo   -w             Ecraser les fichiers existants
echo   -b             Ne pas creer de backup
echo   -h             Afficher cette aide
echo.
exit /b 0

:build_if_needed
if not exist "%GENERATOR_JAR%" (
    echo %YELLOW%JAR non trouve. Compilation en cours...%NC%
    call mvn clean package -DskipTests
    
    if errorlevel 1 (
        echo %RED%Erreur lors de la compilation%NC%
        exit /b 1
    )
    
    echo %GREEN%✓ Compilation reussie%NC%
)
exit /b 0

:main
:: Parse arguments
set OUTPUT_PATH=%DEFAULT_OUTPUT%
set OVERWRITE=
set NO_BACKUP=
set INPUT_FILE=

:parse_args
if "%~1"=="" goto :end_parse
if "%~1"=="-o" (
    set OUTPUT_PATH=%~2
    shift
    shift
    goto :parse_args
)
if "%~1"=="-w" (
    set OVERWRITE=--overwrite
    shift
    goto :parse_args
)
if "%~1"=="-b" (
    set NO_BACKUP=--no-backup
    shift
    goto :parse_args
)
if "%~1"=="-h" (
    call :usage
    exit /b 0
)
set INPUT_FILE=%~1
shift
goto :parse_args

:end_parse

:: Validation
if "%INPUT_FILE%"=="" (
    echo %RED%Erreur: Fichier d'entree requis%NC%
    call :usage
    exit /b 1
)

if not exist "%INPUT_FILE%" (
    echo %RED%Erreur: Fichier non trouve: %INPUT_FILE%%NC%
    exit /b 1
)

:: Build
call :build_if_needed
if errorlevel 1 exit /b 1

:: Affichage config
echo %BLUE%Configuration:%NC%
echo   Fichier d'entree: %INPUT_FILE%
echo   Repertoire de sortie: %OUTPUT_PATH%
echo   Ecraser: %OVERWRITE%
echo   Backup: %NO_BACKUP%
echo.

:: Execution
echo %BLUE%Generation en cours...%NC%
echo.

java -jar "%GENERATOR_JAR%" "%INPUT_FILE%" "%OUTPUT_PATH%" %OVERWRITE% %NO_BACKUP%

if errorlevel 0 (
    echo.
    echo %GREEN%╔════════════════════════════════════════════════════════════╗%NC%
    echo %GREEN%║              GENERATION TERMINEE AVEC SUCCES !             ║%NC%
    echo %GREEN%╚════════════════════════════════════════════════════════════╝%NC%
    echo.
    echo %BLUE%Repertoire de sortie:%NC% %OUTPUT_PATH%
) else (
    echo.
    echo %RED%✗ Erreur lors de la generation%NC%
    exit /b 1
)

endlocal

<!-- ============================================================================
     CONFIGURATION LOGBACK
     ============================================================================
     Fichier: src/main/resources/logback.xml
     ============================================================================ -->
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>

    <appender name="FILE" class="ch.qos.logback.core.FileAppender">
        <file>logs/generator.log</file>
        <encoder>
            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>

    <root level="INFO">
        <appender-ref ref="CONSOLE" />
        <appender-ref ref="FILE" />
    </root>

    <logger name="com.nexusai.tools" level="DEBUG" />
</configuration>

<!-- ============================================================================
     README
     ============================================================================
     Fichier: README.md
     ============================================================================ -->
# NexusAI Project Structure Generator

Outil pour générer automatiquement l'arborescence d'un projet à partir de fichiers de documentation.

## Installation

```bash
# Cloner le projet
git clone https://github.com/nexusai/project-generator.git
cd project-generator

# Compiler
mvn clean package
```

## Usage

### Ligne de commande

```bash
# Usage basique
java -jar target/project-structure-generator-1.0.0-jar-with-dependencies.jar \
  docs/module-7.md \
  ./output

# Avec overwrite
java -jar target/project-structure-generator-1.0.0-jar-with-dependencies.jar \
  docs/module-7.md \
  ./output \
  --overwrite
```

### Script Shell (Linux/Mac)

```bash
# Rendre exécutable
chmod +x scripts/generate-project.sh

# Exécuter
./scripts/generate-project.sh docs/module-7.md

# Avec options
./scripts/generate-project.sh -o ./custom-output -w docs/module-7.md
```

### Script Batch (Windows)

```cmd
scripts\generate-project.bat docs\module-7.md
scripts\generate-project.bat -o .\custom-output -w docs\module-7.md
```

## Fonctionnalités

- ✅ Parse les blocs de code Markdown
- ✅ Détection automatique du type de fichier
- ✅ Création automatique de l'arborescence
- ✅ Backup des fichiers existants
- ✅ Support multi-langages (Java, XML, YAML, SQL, Python, Bash, etc.)
- ✅ Extraction des chemins depuis commentaires
- ✅ Statistiques de génération

## Formats Supportés

Le générateur reconnaît les formats suivants dans les fichiers Markdown:

```markdown
```java
// Fichier: src/main/java/com/example/Test.java
package com.example;
public class Test {}
```
```

Ou avec commentaires XML:

```markdown
<!-- Fichier: config.xml -->
<configuration>
  ...
</configuration>
```
