# Module User avec Authentification

## ðŸ“ Structure du Projet

```
project-root/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ database.js          # ./src/config/database.js
â”‚   â”‚   â””â”€â”€ env.js                # ./src/config/env.js
â”‚   â”‚
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ User.js               # ./src/models/User.js
â”‚   â”‚
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â””â”€â”€ authController.js    # ./src/controllers/authController.js
â”‚   â”‚
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ authRoutes.js         # ./src/routes/authRoutes.js
â”‚   â”‚
â”‚   â”œâ”€â”€ middlewares/
â”‚   â”‚   â”œâ”€â”€ authMiddleware.js    # ./src/middlewares/authMiddleware.js
â”‚   â”‚   â””â”€â”€ validateMiddleware.js # ./src/middlewares/validateMiddleware.js
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ tokenUtils.js         # ./src/utils/tokenUtils.js
â”‚   â”‚   â””â”€â”€ passwordUtils.js      # ./src/utils/passwordUtils.js
â”‚   â”‚
â”‚   â””â”€â”€ app.js                    # ./src/app.js
â”‚
â”œâ”€â”€ .env                          # ./.env
â”œâ”€â”€ .gitignore                    # ./.gitignore
â”œâ”€â”€ package.json                  # ./package.json
â””â”€â”€ server.js                     # ./server.js
```

---

## ðŸ“„ Fichiers du Module

### 1. **package.json** - `./package.json`

```json
{
  "name": "user-auth-module",
  "version": "1.0.0",
  "description": "Module d'authentification utilisateur",
  "main": "server.js",
  "scripts": {
    "start": "node server.js",
    "dev": "nodemon server.js"
  },
  "dependencies": {
    "express": "^4.18.2",
    "mongoose": "^8.0.0",
    "bcryptjs": "^2.4.3",
    "jsonwebtoken": "^9.0.2",
    "dotenv": "^16.3.1",
    "express-validator": "^7.0.1",
    "cors": "^2.8.5"
  },
  "devDependencies": {
    "nodemon": "^3.0.1"
  }
}
```

---

### 2. **.env** - `./.env`

```env
# Configuration du serveur
PORT=5000
NODE_ENV=development

# Configuration de la base de donnÃ©es
MONGODB_URI=mongodb://localhost:27017/user_auth_db

# Configuration JWT
JWT_SECRET=votre_secret_super_securise_ici_changez_le
JWT_EXPIRE=7d

# Configuration refresh token
REFRESH_TOKEN_SECRET=votre_refresh_token_secret_ici
REFRESH_TOKEN_EXPIRE=30d
```

---

### 3. **.gitignore** - `./.gitignore`

```
node_modules/
.env
*.log
.DS_Store
coverage/
dist/
build/
```

---

### 4. **server.js** - `./server.js`

```javascript
const app = require('./src/app');
const connectDB = require('./src/config/database');
require('dotenv').config();

const PORT = process.env.PORT || 5000;

// Connexion Ã  la base de donnÃ©es
connectDB();

// DÃ©marrage du serveur
app.listen(PORT, () => {
  console.log(`ðŸš€ Serveur dÃ©marrÃ© sur le port ${PORT}`);
  console.log(`ðŸ“ Environnement: ${process.env.NODE_ENV}`);
});
```

---

### 5. **src/app.js** - `./src/app.js`

```javascript
const express = require('express');
const cors = require('cors');
const authRoutes = require('./routes/authRoutes');

const app = express();

// Middlewares globaux
app.use(cors());
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// Routes
app.use('/api/auth', authRoutes);

// Route de test
app.get('/api/health', (req, res) => {
  res.json({ status: 'OK', message: 'API fonctionne correctement' });
});

// Gestion des erreurs 404
app.use((req, res) => {
  res.status(404).json({ message: 'Route non trouvÃ©e' });
});

// Gestion des erreurs globales
app.use((err, req, res, next) => {
  console.error(err.stack);
  res.status(500).json({ 
    message: 'Erreur serveur', 
    error: process.env.NODE_ENV === 'development' ? err.message : undefined 
  });
});

module.exports = app;
```

---

### 6. **src/config/database.js** - `./src/config/database.js`

```javascript
const mongoose = require('mongoose');

const connectDB = async () => {
  try {
    const conn = await mongoose.connect(process.env.MONGODB_URI, {
      useNewUrlParser: true,
      useUnifiedTopology: true,
    });

    console.log(`