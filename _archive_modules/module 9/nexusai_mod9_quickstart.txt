# ğŸš€ Guide de DÃ©marrage Rapide - Module 9 : Moderation System

## Pour les nouveaux dÃ©veloppeurs

Ce guide vous permettra de dÃ©marrer rapidement sur le Module 9 de NexusAI.

---

## ğŸ“‹ Checklist d'installation (5 minutes)

```bash
# 1. VÃ©rifier les prÃ©requis
java -version    # Java 21+ requis
mvn -version     # Maven 3.9+ requis
docker --version # Docker requis

# 2. Cloner le projet
git clone https://github.com/nexusai/nexus-moderation.git
cd nexus-moderation

# 3. Lancer les dÃ©pendances
docker-compose up -d

# 4. CrÃ©er le fichier .env
cp .env.example .env
# Ã‰diter .env avec vos clÃ©s API

# 5. Compiler et lancer
mvn clean install
mvn spring-boot:run

# 6. VÃ©rifier que Ã§a fonctionne
curl http://localhost:8084/actuator/health
```

âœ… Si vous voyez `{"status":"UP"}`, c'est bon !

---

## ğŸ¯ Votre premiÃ¨re contribution

### Ã‰tape 1 : Comprendre la structure

```
nexus-moderation/
â”œâ”€â”€ src/main/java/com/nexusai/moderation/
â”‚   â”œâ”€â”€ controller/         â† REST APIs
â”‚   â”œâ”€â”€ service/           â† Logique mÃ©tier (VOTRE CODE ICI)
â”‚   â”œâ”€â”€ model/             â† EntitÃ©s et DTOs
â”‚   â””â”€â”€ repository/        â† AccÃ¨s base de donnÃ©es
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ application.yml    â† Configuration
â”‚   â””â”€â”€ db/migration/      â† Scripts SQL (Flyway)
â””â”€â”€ src/test/             â† Tests (OBLIGATOIRE)
```

### Ã‰tape 2 : Choisir votre tÃ¢che

Selon votre numÃ©ro de dÃ©veloppeur :

```
ğŸ‘¤ Dev 1 : Core Moderation (TextModerationService)
ğŸ‘¤ Dev 2 : Media Moderation (ImageModerationService)
ğŸ‘¤ Dev 3 : Detection (DistressDetectionService)
ğŸ‘¤ Dev 4 : Incidents (IncidentManagementService)
ğŸ‘¤ Dev 5 : Consent (ConsentManagementService)
ğŸ‘¤ Dev 6 : Infrastructure (Controllers, Config)
```

### Ã‰tape 3 : CrÃ©er votre branche

```bash
# Format : feature/MOD9-<numÃ©ro>-<description>
git checkout -b feature/MOD9-123-add-image-moderation
```

### Ã‰tape 4 : Ã‰crire le code

**Exemple** : Ajouter une mÃ©thode dans un service

```java
package com.nexusai.moderation.service.moderation;

import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Service;

/**
 * Service de modÃ©ration d'images.
 * 
 * Analyse les images avec AWS Rekognition et PhotoDNA
 * pour dÃ©tecter du contenu inappropriÃ©.
 * 
 * @author Votre Nom
 */
@Service
@RequiredArgsConstructor
@Slf4j
public class ImageModerationService {
    
    private final RekognitionClient rekognitionClient;
    private final PhotoDNAClient photoDNAClient;
    
    /**
     * ModÃ¨re une image.
     * 
     * @param imageUrl URL de l'image
     * @param userId ID utilisateur
     * @return RÃ©sultat de modÃ©ration
     */
    public ModerationResponse moderateImage(String imageUrl, String userId) {
        log.info("Moderating image for user: {}", userId);
        
        // TODO: ImplÃ©menter la logique
        
        return ModerationResponse.allowed();
    }
}
```

### Ã‰tape 5 : Ã‰crire les tests

**OBLIGATOIRE** : Chaque mÃ©thode publique doit avoir un test !

```java
package com.nexusai.moderation.service.moderation;

import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;

import static org.assertj.core.api.Assertions.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class ImageModerationServiceTest {
    
    @Mock
    private RekognitionClient rekognitionClient;
    
    @Mock
    private PhotoDNAClient photoDNAClient;
    
    @InjectMocks
    private ImageModerationService service;
    
    @Test
    void testModerateImage_CleanImage_ShouldAllow() {
        // Arrange
        String imageUrl = "https://example.com/clean.jpg";
        String userId = "user-123";
        
        when(rekognitionClient.analyze(imageUrl))
            .thenReturn(createCleanResult());
        
        // Act
        ModerationResponse response = service.moderateImage(imageUrl, userId);
        
        // Assert
        assertThat(response.isAllowed()).isTrue();
    }
}
```

### Ã‰tape 6 : Lancer les tests

```bash
# Tests unitaires
mvn test

# VÃ©rifier le coverage
mvn jacoco:report
open target/site/jacoco/index.html
```

ğŸ¯ **Objectif** : Coverage minimum 80%

### Ã‰tape 7 : Commit & Push

```bash
# VÃ©rifier les changements
git status

# Ajouter vos fichiers
git add src/main/java/com/nexusai/moderation/service/moderation/ImageModerationService.java
git add src/test/java/com/nexusai/moderation/service/moderation/ImageModerationServiceTest.java

# Commit avec message explicite
git commit -m "MOD9-123: Add image moderation service

- Implement moderateImage() method
- Add Rekognition client integration
- Add PhotoDNA CSAM detection
- Add unit tests (coverage: 85%)"

# Push
git push origin feature/MOD9-123-add-image-moderation
```

### Ã‰tape 8 : CrÃ©er une Pull Request

1. Aller sur GitHub
2. Cliquer "Compare & pull request"
3. Remplir le template :

```markdown
## Description
Ajoute le service de modÃ©ration d'images avec dÃ©tection CSAM.

## Changements
- âœ… ImageModerationService
- âœ… Tests unitaires
- âœ… Documentation JavaDoc

## Tests
- [x] Tests unitaires passent
- [x] Coverage > 80%
- [x] Tests d'intÃ©gration passent

## Screenshots
N/A (API backend)

## Checklist
- [x] Code formatÃ© selon Google Style
- [x] JavaDoc complÃ¨te
- [x] Tests Ã©crits
- [x] Pas de secrets dans le code
```

4. Demander une review Ã  2 collÃ¨gues
5. Corriger les commentaires
6. Merge aprÃ¨s approbation ! ğŸ‰

---

## ğŸ› Debugging courant

### ProblÃ¨me : L'application ne dÃ©marre pas

**Erreur** : `Connection refused: postgres`

**Solution** :
```bash
# VÃ©rifier que Docker tourne
docker ps

# RedÃ©marrer les conteneurs
docker-compose down
docker-compose up -d

# Attendre 10 secondes
sleep 10

# Relancer l'app
mvn spring-boot:run
```

### ProblÃ¨me : Tests qui Ã©chouent

**Erreur** : `org.testcontainers.containers.ContainerLaunchException`

**Solution** :
```bash
# VÃ©rifier que Docker est actif
docker info

# Pull les images nÃ©cessaires
docker pull postgres:16-alpine
docker pull confluentinc/cp-kafka:7.5.0

# Relancer les tests
mvn test
```

### ProblÃ¨me : OpenAI API timeout

**Erreur** : `SocketTimeoutException: Read timed out`

**Solution** :
```yaml
# Dans application.yml
moderation:
  openai:
    timeout: 10000  # Augmenter Ã  10 secondes
```

---

## ğŸ“š Ressources utiles

### Documentation interne

- ğŸ“– [Architecture complÃ¨te](./docs/architecture.md)
- ğŸ”§ [Guide de contribution](./CONTRIBUTING.md)
- ğŸ§ª [StratÃ©gie de tests](./docs/testing-strategy.md)
- ğŸ³ [Guide Docker](./docs/docker-guide.md)

### Liens externes

- [OpenAI Moderation API](https://platform.openai.com/docs/guides/moderation)
- [AWS Rekognition](https://docs.aws.amazon.com/rekognition/)
- [Spring Boot Docs](https://docs.spring.io/spring-boot/docs/current/reference/html/)
- [Testcontainers](https://www.testcontainers.org/)

### Outils recommandÃ©s

- **IDE** : IntelliJ IDEA Ultimate (licence fournie)
- **DB Client** : DBeaver ou pgAdmin
- **API Testing** : Postman ou Insomnia
- **Git GUI** : SourceTree ou GitKraken

---

## ğŸ’¡ Conseils de pro

### 1. Utilisez les logs intelligemment

```java
// âŒ Mauvais
log.info("Method called");

// âœ… Bon
log.debug("Moderating text for user: {}, length: {}", userId, content.length());
log.warn("High confidence inappropriate content: {} (score: {})", category, score);
log.error("Failed to call OpenAI API", exception);
```

### 2. GÃ©rez les exceptions proprement

```java
// âŒ Mauvais
try {
    openAIClient.moderate(text);
} catch (Exception e) {
    return null; // ğŸ˜±
}

// âœ… Bon
try {
    return openAIClient.moderate(text);
} catch (OpenAIException e) {
    log.error("OpenAI moderation failed", e);
    throw new ModerationException("Moderation service unavailable", e);
}
```

### 3. Ã‰crivez des tests lisibles

```java
// âŒ Mauvais
@Test
void test1() {
    assertEquals(true, service.method("input"));
}

// âœ… Bon
@Test
void testModerateText_CleanContent_ShouldAllow() {
    // Arrange
    String cleanContent = "Hello world";
    
    // Act
    ModerationResponse response = service.moderateText(cleanContent, userId);
    
    // Assert
    assertThat(response.isAllowed()).isTrue();
}
```

### 4. Documentez votre code

```java
/**
 * ModÃ¨re du contenu textuel.
 * 
 * Cette mÃ©thode :
 * 1. VÃ©rifie la blacklist
 * 2. Appelle l'API OpenAI
 * 3. Applique les rÃ¨gles de modÃ©ration
 * 4. DÃ©tecte la dÃ©tresse psychologique
 * 
 * @param content Le texte Ã  modÃ©rer (non null)
 * @param userId ID de l'utilisateur (format UUID)
 * @param conversationId ID de la conversation (peut Ãªtre null)
 * @return RÃ©sultat de la modÃ©ration (jamais null)
 * @throws ModerationException si l'API est indisponible
 */
public ModerationResponse moderateText(
        String content, 
        String userId, 
        String conversationId) {
    // ...
}
```

---

## ğŸ“ Formation recommandÃ©e

### Semaine 1 : Onboarding
- [ ] Lire la documentation complÃ¨te
- [ ] Setup environnement local
- [ ] Lancer les tests et comprendre le coverage
- [ ] Faire une petite PR (fix typo, amÃ©lioration doc)

### Semaine 2 : DÃ©veloppement
- [ ] ImplÃ©menter votre premier service
- [ ] Ã‰crire les tests associÃ©s
- [ ] Review de code d'un collÃ¨gue
- [ ] Participer Ã  la daily standup

### Semaine 3 : Autonomie
- [ ] Prendre une tÃ¢che complexe
- [ ] Faire des tests d'intÃ©gration
- [ ] Optimiser les performances
- [ ] Aider un nouveau dÃ©veloppeur

---

## ğŸ¤ Qui contacter ?

| Question | Contact | Canal |
|----------|---------|-------|
| Architecture | @tech-lead | #moderation-arch |
| Bugs | @qa-team | #moderation-bugs |
| DÃ©ploiement | @devops | #deployments |
| APIs externes | @api-team | #external-apis |
| Questions gÃ©nÃ©rales | Toute l'Ã©quipe | #moderation-general |

---

## âœ… Checklist journaliÃ¨re

Chaque matin :
```bash
# 1. Pull les derniers changements
git checkout develop
git pull origin develop

# 2. Mettre Ã  jour votre branche
git checkout feature/MOD9-XXX
git rebase develop

# 3. Lancer les tests
mvn clean test

# 4. Commencer Ã  coder ! ğŸš€
```

Chaque soir :
```bash
# 1. Commit votre travail
git add .
git commit -m "WIP: description"

# 2. Push (backup)
git push origin feature/MOD9-XXX

# 3. Mettre Ã  jour le ticket Jira
# Status: "In Progress" â†’ "Ready for Review"
```

---

## ğŸ‰ FÃ©licitations !

Vous Ãªtes maintenant prÃªt Ã  contribuer au Module 9 ! 

**N'oubliez pas** :
- ğŸ’¬ Poser des questions (aucune question n'est bÃªte)
- ğŸ§ª Tester, tester, tester
- ğŸ“ Documenter votre code
- ğŸ¤ Aider vos collÃ¨gues
- ğŸ¯ S'amuser en codant !

**Bon dÃ©veloppement ! ğŸš€**

---

**DerniÃ¨re mise Ã  jour** : 21 octobre 2025  
**Auteur** : NexusAI Moderation Team  
**Version** : 1.0.0
